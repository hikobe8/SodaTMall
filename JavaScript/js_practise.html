<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>JavaScript 基础</title>
    <script>
        console.log("Hello JavaScript");
        var a = 10

        document.write('a.toString()=' + a.toString() + '<br/>');
        document.write('a.toString(2)=' + a.toString(2) + '<br/>');
        document.write('a.toString(8)=' + a.toString(8) + '<br/>');
        document.write('a.toString(16)=' + a.toString(16) + '<br/>');
        document.write('2 + 3 = ' + add(2, 3));
        br();

        // 输出换行符
        function br() {
            document.write('<br/>');
        }

        function add(a, b) {
            return a + b;
        }

        function addTwo() {
            var a = parseInt(document.getElementById('num1').value);
            var b = parseInt(document.getElementById('num2').value);
            var op = document.getElementById("op").selectedIndex;
            var result = a + b;
            if (op == 1) {
                result = a - b;
            } else if (op == 2) {
                result = a * b;
            } else if (op == 3) {
                result = a / b;
            }

            document.getElementById('result').value = result.toString();
        }

        function fun1(a) {
            document.write(a + "是局部变量");
        }

        function fun2() {
            a = 100;
            document.write('修改全局变量a = 100');
        }

        function fun3() {
            document.write("修改后的全局变量 a = " + a);
        }

        fun1(20);
        br();
        fun2();
        br();
        fun3();
        br();

        function compare1(a, b) {
            var result = a == b;
            document.write(a + ":" + typeof (a) + "==" + b + ":" + typeof (b) + "->" + result)
        }

        function compare2(a, b) {
            var result = a === b;
            document.write(a + ":" + typeof (a) + "===" + b + ":" + typeof (b) + "->" + result)
        }

        compare1(1, '1');
        br();
        compare2(1, '1');
        br();

        function getDayInWeek() {
            var day = new Date().getDay();
            var result = "";
            switch (day) {
                case 0:
                    result = "星期天";
                    break;
                case 1:
                    result = "星期一";
                    break;
                case 2:
                    result = "星期二";
                    break;
                case 3:
                    result = "星期三";
                    break;
                case 4:
                    result = "星期四";
                    break;
                case 5:
                    result = "星期五";
                    break;
                default:
                    result = "星期六";
                    break;
            }
            return result;
        }

        document.write(getDayInWeek());
        br();

        try {
            fun100();
        } catch (err) {
            document.write(err.message);
        }
        br();

        //计算利率
        function calclixi(base, powder) {
            if (1 == powder) {
                return base;
            }
            if (0 == powder)
                return 1;
            var result = base;
            for (var i = 0; i < powder - 1; i++) {
                result = result * base;
            }
            return result;
        }

        //计算复利率
        function calcfuli(rate, year) {
            var result = 0;
            for (var i = year; i > 0; i--) {
                result += calclixi(rate, i);
            }
            return result;
        }

        function calcMoney() {
            var money = parseInt(document.getElementById("money").value)
            var year = parseInt(document.getElementById("year").value)
            var rate = parseFloat(document.getElementById("rate").value) / 100.0;
            var add_money = parseFloat(document.getElementById("add_money").value);
            var totalm = money + (add_money * (year - 1)); // 本金和
            var total = add_money * calcfuli(1 + rate, year - 1) + money * calclixi(1 + rate, year); // 本息和
            document.getElementById('totalm').value = totalm;
            document.getElementById('totalx').value = total - totalm;
            document.getElementById('total').value = total;
        }

        function addTwoScience() {
            var a = new Number(document.getElementById('nums_1').value);
            var b = new Number(document.getElementById('nums_2').value);
            var op = document.getElementById("op_s").selectedIndex;
            var result = a + b;
            if (op == 1) {
                result = a - b;
            } else if (op == 2) {
                result = a * b;
            } else if (op == 3) {
                result = a / b;
            }

            document.getElementById('result_s').value = result.toExponential();
        }

        // var timeout = setTimeout(() => {
        //     alert('3秒钟过去了');
        // }, 3000);

        // var timeout = setTimeout(() => {
        //     clearInterval(interval);
        //     alert('结束打印interval');
        // }, 5000);

        // var interval = setInterval(() => {
        //     console.log("--------------------------");
        // }, 1000);

        function print(msg) {
            document.write(msg);
            document.write("<br/>");
        }
        function dom1() {
            var d1 = document.getElementById("d1");
            print("div 元素内容" + d1.childNodes[0].nodeValue);
            print("div style内容" + d1.getAttribute("style"));
        }

        function changeBg() {
            var d1 = document.getElementById("d1");
            d1.setAttribute("style", "background-color: yellow");
        }

        function generateTable() {
            var data = new Array(5);
            data[0] = ['name', 'number', 'champion'];
            data[1] = ['Jordan', '23', '6'];
            data[2] = ['Kobe', '24', '5'];
            data[3] = ['James', '24', '3'];
            data[4] = ['Harden', '13', '0'];
            document.write("<table width='900px' style='border-collapse: collapse'>");
            for (let i = 0; i < 5; i++) {
                for (d in data[i]) {
                    if (i & 1 == 1) {
                        document.write("<td width='20%' style='text-align:center; line-height: 30px; background-color: #f5f5f5;border-bottom:1px solid black'>");
                    } else {
                        document.write("<td width='20%' style='text-align:center; line-height: 30px; border-bottom:1px solid black'>");
                    }
                    document.write(data[i][d]);
                    document.write("</td>");
                }
                document.write("<tr>");
            }
            document.write("</table>");
        }

        function focusInput() {
            document.getElementById("div_input").innerHTML = "输入框调用了onFocus()";
        }

        function blurInput() {
            document.getElementById("div_input").innerHTML = "输入框调用了onBlur()";
        }

        function onBodyLoad() {
            alert("body loaded!");
        }

        function getDiv2() {
            var d2 = document.getElementById('div2');
            alert(d2.childNodes[0].nodeValue);
        }

        function getDiv2Pre() {
            var d2 = document.getElementById('div2');
            //html没有换行，可以直接获取
            alert(d2.previousSibling.innerHTML);
        }


        function getDiv2Next() {
            var d2 = document.getElementById('div2');
            //html换行，换行符也要算为节点可以直接获取
            alert(d2.nextSibling.nextSibling.innerHTML);
        }

        function getChildNodes() {
            var d2 = document.getElementById('div2');
            var content = d2.parentNode.childNodes.length + "个child nodes\n";
            for (let i = 0; i < d2.parentNode.childNodes.length; i++) {
                if (d2.parentNode.childNodes[i].nodeType == 3) {
                    content += d2.parentNode.childNodes[i].nodeValue + "\n";
                } else {
                    content += d2.parentNode.childNodes[i] + "\n";
                }
            }
            alert(content);
        }

        function getChildren() {
            var d2 = document.getElementById('div2');
            var content = d2.parentNode.children.length + "个child nodes\n";
            for (let i = 0; i < d2.parentNode.children.length; i++) {
                content += d2.parentNode.children[i] + "\n";
            }
            alert(content);
        }

        function generateTableByJS() {
            var data = new Array(5);
            data[0] = ['name', 'number', 'champion'];
            data[1] = ['Jordan', '23', '6'];
            data[2] = ['Kobe', '24', '5'];
            data[3] = ['James', '24', '3'];
            data[4] = ['Harden', '13', '0'];
            var content = document.getElementById("table_js");
            var table = document.createElement("table");
            table.setAttribute("border", "1");
            for (let i = 0; i < data.length; i++) {
                var row = document.createElement("tr")
                for (let j = 0; j < data[i].length; j++) {
                    var cell = document.createElement("td");
                    cell.appendChild(document.createTextNode(data[i][j]));
                    cell.setAttribute("style", "text-align: centergit ");
                    row.appendChild(cell);
                }
                table.appendChild(row);
            }
            content.appendChild(table);
        }

        function alertJson(){
            var name = document.getElementById("i_name").value;
            var select = document.getElementById("s_team");
            var teamIndex= select.selectedIndex;
            var team = select[teamIndex].value;
            var number = document.getElementById("i_number").value;
            var player = new Player(name, team, number);
            alert(JSON.stringify(player));
        }

        function Player(name, team, number){
            this.name = name;
            this.team = team;
            this.number = number;
        }

    </script>
</head>

<body onload="onBodyLoad()">
    <button onclick="document.getElementById('target').style.display = 'block'">显示下面的文字</button>
    <button onclick="document.getElementById('target').style.display = 'none'">隐藏下面的文字</button>
    <div id="target" style="background-color: red">显示的内容</div>
    <div style="width:50%">
        Number()和parseInt()一样，都可以用来进行数字的转换
        区别在于，当转换的内容包含非数字的时候，Number() 会返回NaN(Not a Number)
        parseInt() 要看情况，如果以数字开头，就会返回开头的合法数字部分，如果以非数字开头，则返回NaN
    </div>
    <h1>四则运算计算器</h1>
    <input id="num1" type="number" />
    <select id="op">
        <option>+</option>
        <option>-</option>
        <option>*</option>
        <option>/</option>
    </select>
    <input id="num2" type="number">
    <button onclick="addTwo()">=</button>
    <input id="result" type="number" disabled=true />
    <h1>复利计算器</h1>
    <table style="border-collapse: collapse" border="1">
        <tr>
            <td style="width: 40%">起始资金</td>
            <td><input id="money" type="number">￥</td>
        </tr>
        <tr>
            <td>每年收益</td>
            <td><input id="rate" type="number">%</td>
        </tr>
        <tr>
            <td>复利年数</td>
            <td><input id="year" type="number">￥</td>
        </tr>
        <tr>
            <td>每年追加资金</td>
            <td><input id="add_money" type="number">￥</td>
        </tr>
        <tr>
            <td colspan="2"><button onclick="calcMoney()" style="display: block;margin: 0 auto; width: 50%">计算</button>
            </td>
        </tr>
        <tr>
            <td>本金和</td>
            <td><input id="totalm" type="number" disabled=true value="0">￥</td>
        </tr>
        <tr>
            <td>利息和</td>
            <td><input id="totalx" type="number" disabled=true value="0">￥</td>
        </tr>
        <tr>
            <td>本息和</td>
            <td><input id="total" type="number" disabled=true value="0">￥</td>
        </tr>
    </table>

    <h1>四则运算计算器-科学计数法</h1>
    <input id="nums_1" type="number" />
    <select id="op_s">
        <option>+</option>
        <option>-</option>
        <option>*</option>
        <option>/</option>
    </select>
    <input id="nums_2" type="number">
    <button onclick="addTwoScience()">=</button>
    <input id="result_s" type="number" disabled=true />

    <div id="d1" style="background-color: red" onclick="dom1()">div node</div>
    <button onclick="changeBg()">更改上面的背景色位黄色</button>
    <br />
    <button onclick="generateTable()">生成表格</button>

    <form>
        输入框 <input id="input_text" onfocus="focusInput()" onblur="blurInput()" type="text" value="输入框" />
        <div id="div_input"></div>
    </form>

    <h1>childNodes 和 children的区别</h1>
    <h2>childNodes 包含文字节点(<span style="color: red">HTML中的换行符也为空的文字节点</span>)，children不包含文字节点</h2>
    <div style="background-color: blueviolet">
        text content
        <div>第1个div</div>
        <div id="div2">第2个div</div>
        <div>第3个div</div>
        <div>
            <button onclick="getDiv2()">获取第二个div</button>
            <button onclick="getDiv2Pre()">获取前一个div</button>
            <button onclick="getDiv2Next()">获取后一个div</button>
            <button onclick="getChildNodes()">childNodes</button>
            <button onclick="getChildren()">children</button>
        </div>
    </div>
    <button onclick="generateTableByJS()">生成表格</button>
    <div id="table_js"></div>
    <div>
        姓名<input id="i_name" type="text"><br/>
        球队<select id="s_team"><option value="洛杉矶湖人">洛杉矶湖人</option value="芝加哥公牛"><option>芝加哥公牛</option><option value="休斯顿火箭">休斯顿火箭</option></select>
        <br/>
        号码<input id="i_number" type="number"><br/>
        <button onclick="alertJson()">生成json字符串</button>
    </div>
</body>

</html>